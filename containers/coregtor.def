Bootstrap: docker
From: condaforge/miniforge3:latest

%files
    containers/requirements.txt /app/requirements.txt

%post -c /bin/bash
    cd /app
    
    # Install packages available in conda-forge via mamba
    mamba create -y -p /opt/core-3.11 \
        python=3.11 \
        weasyprint \
        numpy \
        pandas \
        scikit-learn \
        matplotlib \
        jupyter \
        seaborn \
        pyyaml \
        requests \
        tqdm \
        -c conda-forge
    
    # Activate environment and install pip requirements
    source activate /opt/core-3.11
    pip install --upgrade pip
    pip install -r /app/requirements.txt


%environment
    export PATH="/opt/core-3.11/bin:$PATH"
